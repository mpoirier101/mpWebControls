<!DOCTYPE html>
<html>
  <head>
    <title>Controls</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" type="text/css" media="screen" href="/css/mpTheme.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/mp.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/mpControls.css" />

    <script src="/js/mpDateRange.js"></script>
    <script src="/js/mpDialog.js"></script>
    <script src="/js/mpCalendar.js"></script>
    <script src="/js/mpCheck.js"></script>
    <script src="/js/mpRadio.js"></script>
    <script src="/js/mpSelect.js"></script>
    <script src="/js/mpSelectMany.js"></script>
    <script src="/js/mpTable.js"></script>
    <script src="/js/mpTextBox.js"></script>
  </head>
  <body>
    
    <h1>Test Controls</h1>

    <form>
      
      <div class="navbar small theme">
        <div id="fullname"></div>
        <div id="sort"></div>
        <div id="district"></div>
        <div id="persist"></div>
        <div id="date"></div>
        <div id="period"></div>
      </div>

      <div class="section">
        <div class="centered">
          <div id="calendar" ></div>
          <div id="horaire" ></div>
        </div>
      </div>

      <div class="section">
        <div class="centered">
          <button type="submit" id="btnSubmit" class="btn theme">Submit</button>
          <button type="button" id="btnDialog" class="btn theme">Show Dialog</button>
        </div>
      </div>
  
    </form>  


  <div class="section">
    <div class="centered">
      <div id="members"></div>
    </div>
  </div>

    <div id="dialog">
      <h1>TEST</h1>
    </div>

    <script>
      var orders = [
        ["asc", "Ascending"],
        ["desc", "Descending"],
      ];

      var districts = [
        ["1", "District 1"],
        ["2", "District 2"],
        ["3", "District 3"],
        ["4", "District 4"],
        ["5", "District 5"],
        ["6", "District 6"],
        ["7", "District 7"],
      ];

      var horaires = [
        [
          ["08:00", "08:00 - 08:30"],
          ["09:30", "09:30 - 10:00"],
          ["13:00", "13:00 - 13:30"],
          ["15:30", "15:30 - 16:00"],
        ],
        [
          ["08:00", "08:00 - 08:30"],
          ["09:00", "09:00 - 09:30"],
          ["10:00", "10:00 - 10:30"],
          ["10:30", "10:30 - 11:00"],
          ["11:00", "11:00 - 11:30"],
          ["14:00", "14:00 - 14:30"],
          ["15:30", "15:30 - 16:00"],
        ]
      ];

      var savings = [
        ["January", "100"],
        ["February", "130"],
        ["March", "200"],
        ["April", "180"],
        ["May", "110"],
        ["June", "90"],
      ]

      var members = [
      {
        "id": 1,
        "first_name": "Jeanette",
        "last_name": "Penddreth",
        "email": "jpenddreth0@census.gov",
        "gender": "Female",
        "ip_address": "26.58.193.2"
      }, {
        "id": 2,
        "first_name": "Giavani",
        "last_name": "Frediani",
        "email": "gfrediani1@senate.gov",
        "gender": "Male",
        "ip_address": "229.179.4.212"
      }, {
        "id": 3,
        "first_name": "Noell",
        "last_name": "Bea",
        "email": "nbea2@imageshack.us",
        "gender": "Female",
        "ip_address": "180.66.162.255"
      }, {
        "id": 4,
        "first_name": "Willard",
        "last_name": "Valek",
        "email": "wvalek3@vk.com",
        "gender": "Male",
        "ip_address": "67.76.188.26"
      }];

      var json = '[{"id": 1,"first_name": "Jeanette","last_name": "Penddreth","email": "jpenddreth0@census.gov","gender": "Female","ip_address": "26.58.193.2"},' + 
      '{"id": 2,"first_name": "Giavani","last_name": "Frediani","email": "gfrediani1@senate.gov","gender": "Male","ip_address": "229.179.4.212"},' +
      '{"id": 3,"first_name": "Noell","last_name": "Bea","email": "nbea2@imageshack.us","gender": "Female","ip_address": "180.66.162.255"},' +
      '{"id": 4,"first_name": "Willard","last_name": "Valek","email": "wvalek3@vk.com","gender": "Male","ip_address": "67.76.188.26"}]';

      var columns = [
        {"data": "first_name", "display":"First Name", "sort":""},
        {"data": "last_name", "display":"Last Name", "sort":""},
        {"data": "email", "display":"Email", "sort":""},
        {"data": "gender", "display":"Gender", "sort":""},
      ];

      var selectedName = "Michel Poirier";
      var selectedOrder = "asc";
      var selectedDistrict = ["2","4"];
      var selectedDate = "2020-06-11";
      var selectedDates = ["2020-03-01", "2020-03-31"];
    </script>

  <script>

      (function () {

        // ---------------------------------
        // mp-text
        // ---------------------------------
        var fullname = new mpText("fullname", {
          value: selectedName,
          caption: "Display name:",
          placeholder: "Enter full name",
          pattern: "",
          required: true,
        }); 
        fullname.on("input", function(e){
          console.log(e.detail);
        });

        // ---------------------------------
        // mp-select
        // ---------------------------------
        var sort = new mpSelect("sort", {
          caption: "Sort Order:",
          list: orders, 
          //value: selectedOrder,
          required: true,
        });
        sort.on("changed", function(e){
          console.log(e.detail);
        });

        // ---------------------------------
        // mp-check
        // ---------------------------------
        var persist = new mpCheck("persist", {
          caption: "Persist",
          name: "persist",
          //value: selectedOrder,
          //required: true,
        });
        persist.on("changed", function(e){
          console.log(e.detail);
        });

        // ---------------------------------
        // mp-selectmany
        // ---------------------------------
        var district = new mpSelectMany("district", {
          caption: "District(s):",
          list: districts, 
          //values: selectedDistrict,
          required: true,
        });
        district.on("changed", function(e){
          console.log(e.detail);
        });

        // ---------------------------------
        // mp-date
        // ---------------------------------
        var date = new mpText("date", {
          type: "date",
          value: selectedDate,
          caption: "Select Date:",
          pattern: "\d{4}-\d{2}-\d{2}",
          required: true,
        });
        date.on("input", function(e){
          console.log(e.detail);
        });

        // ---------------------------------
        // mp-daterange
        // ---------------------------------
        var period = new mpDateRange("period", {
          values: selectedDates,
          captions: ["Debut:","Fin:"],
          pattern: "\d{4}-\d{2}-\d{2}",
          required: true,
          width: "600px",
        });
        period.on("input", function(e){
          console.log(e.detail);
        });

        // ---------------------------------
        // mpCalendar
        // ---------------------------------
        var cal = new mpCalendar("calendar", {
          disablePastDays: true
        });
        cal.on("changed", function(e){
          console.log(e.detail);
          var date = new Date(e.detail).getDate();
          var idx = date % 2
          window.horaire.setList(horaires[idx]);
        });

        // ---------------------------------
        // mpRadio
        // ---------------------------------
        window.horaire = new mpRadio("horaire", {
          caption: "Horaire:",
          name: "heure",
          //list: horaires[0], 
          required: true,
        });
        horaire.on("changed", function(e){
          console.log(e.detail);
        });


        // ---------------------------------
        // mp-dialog
        // ---------------------------------
        var dialog = new mpDialog("dialog", {
          buttons: [mpDialog.Buttons.Cancel, mpDialog.Buttons.OK],
          title: "Dialog Title",
          width: "460px",
          height: "400px",
        });
        dialog.on("closed", function (event) {
          console.log("Closed event fired: " + event.detail);
        });

        var btn = document.getElementById("btnDialog");
        btn.addEventListener("click", function (event) {
          dialog.open();
          return false;
        });
      
        // ---------------------------------
        // mp-table
        // ---------------------------------
        var table = new mpTable("members", {
          caption: "mpTable example",
          width: "800px",
          height: "200px",
          columns: columns,
          //data: members, // initialize with array
          //json: json, // initialize with JSON
        });
        table.on("rowClick", function (event) {
          console.log("Row Click event fired: " + event.detail);
        });


        // ---------------------------------
        // form
        // ---------------------------------
        document.querySelector("form").addEventListener("submit", function (event) {
          event.preventDefault();
          var form = document.querySelector('form');
          var formData = new FormData(form);
          var object = {};
          for (var key of formData.keys()) {
            var value = formData.get(key);
            object[key] = value;
          }
          var json = JSON.stringify(object);
          console.log(`FormData: ${json}`);
        });


        // ---------------------------------
        // load sample json data from file
        // ---------------------------------
        function loadSampleData() {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              table.fillTable(this.responseText, columns);
            }
          };
          xhttp.open("GET", "MOCK_DATA.json", true);
          xhttp.send();
        }

        loadSampleData();
      
      })();
  </script>
  </body>
</html>
